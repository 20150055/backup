(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["job-logs"],{"411e":function(t,e,n){"use strict";var i=n("9ab4"),o=n("60a3"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{attrs:{"fill-height":"","justify-center":"","align-center":"",column:""}},[n("logo",{attrs:{loader:""}}),n("div",{staticStyle:{"min-width":"200px","flex-grow":"0"}},[n("v-progress-linear",{attrs:{value:100*t.value,indeterminate:t.indeterminate||t.automaticIndeterminate,color:"accent"}})],1)],1)},r=[],s=n("ee1b"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i["d"](e,t),Object.defineProperty(e.prototype,"automaticIndeterminate",{get:function(){return this.value>.99},enumerable:!0,configurable:!0}),i["c"]([Object(o["Prop"])({type:Number,default:0,validator:function(t){return t>=0&&t<=1}})],e.prototype,"value",void 0),i["c"]([Object(o["Prop"])({type:Boolean,default:!1})],e.prototype,"indeterminate",void 0),e=i["c"]([Object(o["Component"])({components:{Logo:s["default"]}})],e),e}(Object(o["Mixins"])()),c=l,u=c,d=n("2877"),p=n("6544"),h=n.n(p),g=n("a722"),f=n("8e36"),v=Object(d["a"])(u,a,r,!1,null,null,null),m=v.exports;h()(v,{VLayout:g["a"],VProgressLinear:f["a"]}),n.d(e,"a",function(){return b});var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentLoadingPercentage=1,e.shouldFinishLoading=!1,e}return i["d"](e,t),Object.defineProperty(e.prototype,"currentlyLoading",{get:function(){return this.currentLoadingPercentage<1},enumerable:!0,configurable:!0}),e.prototype.setLoading=function(t){t?(this.currentLoadingPercentage=0,this.shouldFinishLoading=!1):this.shouldFinishLoading=!0},e.prototype.updateLoadingPercentage=function(){var t=this;this.currentlyLoading&&setTimeout(function(){t.currentLoadingPercentage+=t.shouldFinishLoading?.3:Math.random()*(.1*(1-t.currentLoadingPercentage)),t.shouldFinishLoading&&(t.currentLoadingPercentage=Math.max(.99,t.currentLoadingPercentage)),t.currentlyLoading&&t.updateLoadingPercentage()},this.shouldFinishLoading?500:200*Math.random())},i["c"]([Object(o["Watch"])("currentlyLoading")],e.prototype,"updateLoadingPercentage",null),e=i["c"]([Object(o["Component"])({components:{FullscreenLoader:m}})],e),e}(o["Vue"])},"49ea":function(t,e,n){},"823f":function(t,e,n){},"85ad":function(t,e,n){"use strict";var i=n("49ea"),o=n.n(i);o.a},bba1:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.currentlyLoading?n("fullscreen-loader",{attrs:{value:t.currentLoadingPercentage}}):n("div",{staticClass:"ma-4"},[n("v-container",[n("timeline",{attrs:{type:"backupjob","job-id":t.jobId}})],1)],1)},o=[],a=n("9ab4"),r=n("60a3"),s=n("411e"),l=n("f33f"),c=n("da9e"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a["d"](e,t),Object.defineProperty(e.prototype,"jobId",{get:function(){return l["routerModule"].params.jobId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jobData",{get:function(){return l["jobsModule"].getById(this.jobId)},enumerable:!0,configurable:!0}),e.prototype.mounted=function(){var t=this;this.setLoading(!0),setTimeout(function(){return t.setLoading(!1)},0)},e=a["c"]([Object(r["Component"])({components:{Timeline:c["a"]}})],e),e}(Object(r["Mixins"])(s["a"])),d=u,p=d,h=n("2877"),g=n("6544"),f=n.n(g),v=n("a523"),m=Object(h["a"])(p,i,o,!1,null,null,null);e["default"]=m.exports;f()(m,{VContainer:v["a"]})},da9e:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticStyle:{"max-width":"800px"}},[n("v-timeline",{attrs:{dense:"",clipped:""}},[n("v-timeline-item",{staticClass:"white--text mb-5",attrs:{"fill-dot":"",color:"primary",large:""}},[n("v-icon",{attrs:{slot:"icon"},slot:"icon"},[t._v("mdi-gesture-tap")]),n("v-card",[n("v-card-actions",{staticClass:"d-flex"},["other"===t.type||"backupjob"===t.type||"repository"===t.type?n("v-btn",{attrs:{flat:"",color:"accent",to:"/jobs/new"}},[t._v(t._s(t.$t("timeline.new-backup-job")))]):t._e(),"other"===t.type||"repository"===t.type?n("v-btn",{attrs:{flat:"",color:"accent",to:"/repositories/new"}},[t._v(t._s(t.$t("timeline.new-repository")))]):t._e(),"other"===t.type||"client"===t.type?n("v-btn",{attrs:{flat:"",color:"accent",to:"/admin/client/new"}},[t._v(t._s(t.$t("timeline.new-client")))]):t._e()],1),n("v-card-actions",{staticClass:"px-4"},[n("v-checkbox",{attrs:{color:"accent",label:t.$t("timeline.show-all-log-types")},model:{value:t.showAllLogTypes,callback:function(e){t.showAllLogTypes=e},expression:"showAllLogTypes"}})],1)],1)],1),n("v-slide-x-transition",{attrs:{group:""}},[t._l(t.computedEvents,function(e){return[n("v-timeline-item",{key:e.id,staticClass:"mb-3",attrs:{color:e.dotColor,small:"","fill-dot":"","hide-dot":!e.dotColor}},[n(e.isSectionHeading?"span":"v-card",{tag:"component"},[n("v-card-title",[n("v-layout",{attrs:{"align-middle":"","align-center":"","justify-center":""}},[e.chips?n("v-flex",{staticClass:"shrink"},t._l(e.chips,function(e,i){return n("v-chip",{key:i,staticClass:"white--text ml-0",class:e.class,attrs:{label:"",small:""}},[t._v(t._s(e.name))])}),1):t._e(),n("v-flex",{staticClass:"grow",class:e.isSectionHeading&&"title"},[t._v(t._s(t.$t(e.heading)))]),n("v-flex",{staticClass:"shrink"},[t._v(t._s(e.time))])],1)],1),e.text?n("v-card-text",[n("v-layout",{attrs:{"justify-space-between":""}},[n("v-flex",{attrs:{xs7:""}},[n("pre",{staticClass:"full-log"},[t._v(t._s(e.text))])])],1)],1):t._e(),e.actions||!e.isSectionHeading?n("v-card-actions",[n("v-spacer"),t._l(e.actions,function(e,i){return n("v-btn",{key:i,attrs:{flat:"",color:"accent"}},[t._v(t._s(e.text))])}),n("v-btn",{attrs:{flat:"",color:"accent"},on:{click:function(n){return t.showEventDetails(e)}}},[t._v(t._s(t.$t("timeline.show-details")))])],2):t._e()],1)],1)]})],2)],1),n("v-layout",{attrs:{"justify-center":"","align-center":"",column:""}},[n("v-btn",{attrs:{icon:"",large:"",fab:"",outline:"",color:"accent",disabled:t.noMoreEntries,loading:t.loading},on:{click:t.fetchLogs}},[n("v-icon",{attrs:{"x-large":""}},[t._v("mdi-chevron-down")])],1),t.noMoreEntries?n("v-flex",{staticClass:"text-xs-center grey--text",attrs:{xs12:""}},[t._v(t._s(t.$t("timeline.no-more-entries")))]):t._e()],1),n("v-dialog",{attrs:{"max-width":"1000px",scrollable:""},model:{value:t.dialogOpen,callback:function(e){t.dialogOpen=e},expression:"dialogOpen"}},[n("v-card",[n("v-card-title",{class:(t.currentEventDetails||{}).dotColor},[n("span",{staticClass:"headline"},[t._v(t._s(t.$t("timeline.details.headline")))])]),t.currentEventDetails?n("v-card-text",[n("p",[t._v(t._s(t.$t("timeline.details.id"))+": "+t._s(t.currentEventDetails.id))]),n("p",[t._v(t._s(t.$t("timeline.details.date"))+": "+t._s(t.$d(t.currentEventDetails.date,"long")))]),n("div",[t._v(t._s(t.$t("timeline.details.log-file-content"))+":")]),n("div",{staticClass:"full-log"},[t._v(t._s(t.currentEventDetails.fullText))])]):t._e(),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{target:"_blank",href:t.logDetailsUrl,flat:""}},[t._v(t._s(t.$t("timeline.details.open-in-new-tab")))]),n("v-btn",{attrs:{color:"accent",flat:""},nativeOn:{click:function(e){t.dialogOpen=!1}}},[t._v(t._s(t.$t("common.interaction.close")))])],1)],1)],1)],1)},o=[],a=n("9ab4"),r=n("60a3"),s=n("340b"),l=n("f33f"),c=n("845e"),u=n("52cf"),d=n.n(u),p=n("6e0c"),h=n.n(p),g=n("d378"),f=n("be95"),v=n("ee1b"),m=n("e49c"),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dialogOpen=!1,e.currentEventDetails=null,e.loading=!1,e.noMoreEntries=!1,e.showAllLogTypes=!1,e.events=[],e.interval=0,e}return a["d"](e,t),Object.defineProperty(e.prototype,"logDetailsUrl",{get:function(){return this.currentEventDetails&&""+f["baseUrl"]+Object(f["getLogDetailsUrl"])(this.currentEventDetails.id)},enumerable:!0,configurable:!0}),e.prototype.showEventDetails=function(t){return a["b"](this,void 0,void 0,function(){var e,n;return a["e"](this,function(i){switch(i.label){case 0:this.dialogOpen=!0,console.log(t.id),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(f["getLogDetails"])(Number(t.id))];case 2:return e=i.sent(),e?(this.currentEventDetails=a["a"]({},t,{fullText:e}),[2]):[3,4];case 3:return n=i.sent(),console.log(n),[3,4];case 4:return this.dialogOpen=!1,[2]}})})},Object.defineProperty(e.prototype,"computedEvents",{get:function(){var t=this,e="";return this.events.slice().flatMap(function(n){var i=a["a"]({},n,{time:n.date&&t.$d(n.date,"time")});if(i.date){var o=Object(g["dateToYYYYMMDDString"])(i.date);if(o!==e){e=o;var r=(t.$d(Object(s["parse"])(o),"short")+" - "+Object(s["distanceInWordsStrict"])(new Date,o,{locale:l["settingsModule"].language===c["Language"].de?h.a:d.a,addSuffix:!0,unit:"d"})).toUpperCase();return[{id:r,isSectionHeading:!0,heading:r},i]}}return i})},enumerable:!0,configurable:!0}),e.prototype.onShowAllLogTypesChange=function(){return a["b"](this,void 0,void 0,function(){return a["e"](this,function(t){switch(t.label){case 0:return[4,this.fetchLogs(!0)];case 1:return t.sent(),[2]}})})},e.prototype.onTypeChange=function(){return a["b"](this,void 0,void 0,function(){return a["e"](this,function(t){switch(t.label){case 0:return[4,this.fetchLogs()];case 1:return t.sent(),[2]}})})},e.prototype.fetchLogs=function(t){return void 0===t&&(t=!1),a["b"](this,void 0,void 0,function(){var e,n,i,o,r;return a["e"](this,function(a){switch(a.label){case 0:n=20,i=!t&&this.events.length&&Number(this.events[this.events.length-1].id)||void 0,this.loading=!0,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Object(f["getLogs"])(this.showAllLogTypes&&{limit:n,offset:i,type:null}||this.type===c["LogType"].other&&{limit:n,type:c["LogType"].other,offset:i}||this.type===c["LogType"].client&&{limit:n,type:c["LogType"].client,clientId:this.clientId,offset:i}||this.type===c["LogType"].backupJob&&{limit:n,type:c["LogType"].backupJob,jobId:this.jobId,offset:i}||{limit:n,type:c["LogType"].repository,repoId:this.repoId,offset:i})];case 2:return o=a.sent(),o.payload&&(t&&(this.events=[]),(e=this.events).push.apply(e,o.payload.logs.map(this.transformLogFromApiToInternal)),o.payload.logs.length!==n&&(this.noMoreEntries=!0)),[3,4];case 3:return r=a.sent(),console.log(r),[3,4];case 4:return this.loading=!1,[2]}})})},e.prototype.transformLogFromApiToInternal=function(t){var e=[];if(t.type===c["LogType"].client){var n=l["adminModule"].clientbyID(t.clientId);n&&e.push({name:n.name,class:m["a"].client})}if(t.type===c["LogType"].repository||t.type===c["LogType"].backupJob){var i=l["repositoriesModule"].getById(t.repoId);i&&e.push({name:i.name,class:m["a"].repo})}if(t.type===c["LogType"].backupJob){var o=l["jobsModule"].getById(t.jobId);o&&e.push({name:o.name,class:m["a"].job})}return{id:t.id,heading:t.eventDescription,dotColor:t.logLevel,date:Object(s["parse"])(t.date),chips:e}},e.prototype.mounted=function(){},e.prototype.beforeDestroy=function(){},a["c"]([Object(r["Prop"])({type:String,required:!0,validator:function(t){return-1!==[c["LogType"].other,c["LogType"].client,c["LogType"].repository,c["LogType"].backupJob].indexOf(t)}})],e.prototype,"type",void 0),a["c"]([Object(r["Prop"])({type:[Number,String],default:0})],e.prototype,"jobId",void 0),a["c"]([Object(r["Prop"])({type:[Number,String],default:0})],e.prototype,"repoId",void 0),a["c"]([Object(r["Prop"])({type:[Number,String],default:0})],e.prototype,"clientId",void 0),a["c"]([Object(r["Watch"])("showAllLogTypes")],e.prototype,"onShowAllLogTypesChange",null),a["c"]([Object(r["Watch"])("type",{immediate:!0})],e.prototype,"onTypeChange",null),e=a["c"]([Object(r["Component"])({components:{Logo:v["default"]}})],e),e}(Object(r["Mixins"])()),y=b,_=y,L=(n("85ad"),n("2877")),j=n("6544"),O=n.n(j),x=n("8336"),C=n("b0af"),w=n("99d9"),T=n("12b2"),I=n("ac7c"),D=n("cc20"),$=n("a523"),k=n("169a"),P=n("0e8f"),E=n("132d"),S=n("a722"),V=n("0789"),M=n("9910"),B=(n("823f"),n("58df")),A=n("6a18"),F=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},J=Object(B["a"])(A["a"]).extend({name:"v-timeline",props:{alignTop:Boolean,dense:Boolean},computed:{classes:function(){return F({"v-timeline--align-top":this.alignTop,"v-timeline--dense":this.dense},this.themeClasses)}},render:function(t){return t("div",{staticClass:"v-timeline",class:this.classes},this.$slots.default)}}),N=n("9d26"),U=n("b64a"),H=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},W=Object(B["a"])(U["a"],A["a"]).extend({name:"v-timeline-item",props:{color:{type:String,default:"primary"},fillDot:Boolean,hideDot:Boolean,icon:String,iconColor:String,large:Boolean,left:Boolean,right:Boolean,small:Boolean},computed:{hasIcon:function(){return!!this.icon||!!this.$slots.icon}},methods:{genBody:function(){return this.$createElement("div",{staticClass:"v-timeline-item__body"},this.$slots.default)},genIcon:function(){return this.$slots.icon?this.$slots.icon:this.$createElement(N["a"],{props:{color:this.iconColor,dark:!this.theme.isDark,small:this.small}},this.icon)},genInnerDot:function(){var t=this.setBackgroundColor(this.color);return this.$createElement("div",H({staticClass:"v-timeline-item__inner-dot"},t),[this.hasIcon&&this.genIcon()])},genDot:function(){return this.$createElement("div",{staticClass:"v-timeline-item__dot",class:{"v-timeline-item__dot--small":this.small,"v-timeline-item__dot--large":this.large}},[this.genInnerDot()])},genOpposite:function(){return this.$createElement("div",{staticClass:"v-timeline-item__opposite"},this.$slots.opposite)}},render:function(t){var e=[this.genBody()];return this.hideDot||e.unshift(this.genDot()),this.$slots.opposite&&e.push(this.genOpposite()),t("div",{staticClass:"v-timeline-item",class:H({"v-timeline-item--fill-dot":this.fillDot,"v-timeline-item--left":this.left,"v-timeline-item--right":this.right},this.themeClasses)},e)}}),Y=Object(L["a"])(_,i,o,!1,null,"9e3ff3d0",null);e["a"]=Y.exports;O()(Y,{VBtn:x["a"],VCard:C["a"],VCardActions:w["a"],VCardText:w["b"],VCardTitle:T["a"],VCheckbox:I["a"],VChip:D["a"],VContainer:$["a"],VDialog:k["a"],VFlex:P["a"],VIcon:E["a"],VLayout:S["a"],VSlideXTransition:V["f"],VSpacer:M["a"],VTimeline:J,VTimelineItem:W})},e49c:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i={client:"orange",repo:"green",job:"blue"}}}]);
//# sourceMappingURL=job-logs.d41de4e2.js.map