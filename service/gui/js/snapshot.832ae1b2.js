(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["snapshot"],{"38ec":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{"max-width":"600px",scrollable:""},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[r("v-card",[r("v-card-title",{staticClass:"accent"},[r("v-layout",{attrs:{column:""}},[r("span",{staticClass:"headline"},[e._v(e._s(e.$t("folder-selector.select-folder")))]),r("div",{},[e._v(e._s(e.chosenLocation||e.$t("folder-selector.no-selection")))])]),r("v-spacer"),r("v-btn",{attrs:{icon:""},on:{click:e.refreshBrowser}},[r("v-icon",[e._v("mdi-refresh")])],1)],1),r("v-card-text",[r("file-browser",{ref:"fileBrowser",staticClass:"elevation-0",attrs:{"hide-chrome":"","hide-selection":"","folder-only":""},model:{value:e.chosenLocations,callback:function(t){e.chosenLocations=t},expression:"chosenLocations"}})],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"accent",flat:""},nativeOn:{click:function(t){e.isOpen=!1}}},[e._v(e._s(e.$t("common.interaction.close")))]),r("v-btn",{attrs:{color:"accent",flat:"",disabled:!e.chosenLocation},nativeOn:{click:function(t){e.$emit("folder-selected",e.chosenLocation),e.isOpen=!1}}},[e._v(e._s(e.$t("common.interaction.confirm")))])],1)],1)],1)},s=[],o=r("9ab4"),i=r("60a3"),a=r("4796"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.chosenLocations=[],t}return o["d"](t,e),t.prototype.onOpen=function(){return o["b"](this,void 0,void 0,function(){return o["e"](this,function(e){switch(e.label){case 0:return this.isOpen?[4,this.$refs.fileBrowser.manuallySetFolders([])]:[3,2];case 1:e.sent(),this.initialLocation&&this.onInitialLocationChange(),e.label=2;case 2:return[2]}})})},t.prototype.onInitialLocationChange=function(){return o["b"](this,void 0,void 0,function(){return o["e"](this,function(e){switch(e.label){case 0:return this.initialLocation?(this.chosenLocations=[this.initialLocation],this.$refs.fileBrowser?[4,this.$refs.fileBrowser.manuallySetFolders([this.initialLocation])]:[3,3]):[3,4];case 1:return e.sent(),[4,this.$refs.fileBrowser.openFolder(this.initialLocation)];case 2:e.sent(),this.chosenLocations=[this.initialLocation],e.label=3;case 3:return[3,5];case 4:this.chosenLocations=[],e.label=5;case 5:return[2]}})})},Object.defineProperty(t.prototype,"isOpen",{get:function(){return this.value},set:function(e){this.$emit("input",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chosenLocation",{get:function(){return this.chosenLocations[0]||!1},enumerable:!0,configurable:!0}),t.prototype.refreshBrowser=function(){return o["b"](this,void 0,void 0,function(){return o["e"](this,function(e){switch(e.label){case 0:return this.$refs.fileBrowser?[4,this.$refs.fileBrowser.refreshBrowser()]:[3,4];case 1:return e.sent(),[4,this.$refs.fileBrowser.manuallySetFolders([this.chosenLocation||this.initialLocation])];case 2:return e.sent(),[4,this.$refs.fileBrowser.openFolder(this.chosenLocation||this.initialLocation)];case 3:e.sent(),e.label=4;case 4:return[2]}})})},o["c"]([Object(i["Prop"])({type:[Boolean],required:!0})],t.prototype,"value",void 0),o["c"]([Object(i["Prop"])({type:String,default:""})],t.prototype,"initialLocation",void 0),o["c"]([Object(i["Watch"])("isOpen")],t.prototype,"onOpen",null),o["c"]([Object(i["Watch"])("initialLocation",{immediate:!0})],t.prototype,"onInitialLocationChange",null),t=o["c"]([Object(i["Component"])({components:{FileBrowser:a["a"]}})],t),t}(Object(i["Mixins"])()),l=c,d=l,u=r("2877"),p=r("6544"),h=r.n(p),f=r("8336"),v=r("b0af"),b=r("99d9"),g=r("12b2"),m=r("169a"),y=r("132d"),_=r("a722"),O=r("9910"),L=Object(u["a"])(d,n,s,!1,null,null,null);t["a"]=L.exports;h()(L,{VBtn:f["a"],VCard:v["a"],VCardActions:b["a"],VCardText:b["b"],VCardTitle:g["a"],VDialog:m["a"],VIcon:y["a"],VLayout:_["a"],VSpacer:O["a"]})},"58db":function(e,t,r){},"68c7":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.currentlyLoading?r("fullscreen-loader",{attrs:{value:e.currentLoadingPercentage}}):r("div",{staticClass:"ma-4"},[r("v-card",[r("v-card-title",[r("span",{staticClass:"mr-2"},[e._v(e._s(e.$t("snapshot.snapshot"))+" "+e._s(e.snapshotId))]),r("v-chip",{attrs:{outline:"",label:"",disabled:"",color:"accent"}},[e._v(e._s(e.repoName))])],1),r("v-card-text",[r("v-list",[r("v-list-tile",[r("v-list-tile-title",[e._v(e._s(e.$t("snapshot.date")))]),r("v-list-tile-sub-title",[e._v(e._s(e.$d(e.details.date))+" ("+e._s(e.$relativeDate(e.details.date))+")")])],1)],1)],1)],1),r("v-card",{staticClass:"mt-3"},[r("v-progress-linear",{staticClass:"ma-0",attrs:{value:e.restoreRunning?e.restoreProgress:0}}),r("v-card-title",{staticClass:"pt-1"},[r("span",{staticClass:"mr-2"},[e._v(e._s(e.$t("snapshot.files.files-in-snapshot")))]),r("v-chip",{attrs:{small:""}},[e._v(e._s(e.selectedFiles.length)+" / "+e._s(e.details.files.length)+" "+e._s(e.$t("snapshot.files.selected")))]),r("v-spacer"),r("v-btn",{attrs:{large:"",color:"accent",disabled:!e.selectedFiles.length||e.restoreRunning,outline:""},on:{click:function(t){e.restoreTargetSelectorOpen=!0}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-backup-restore")]),e._v("\n        "+e._s(e.$t("snapshot.restore-now"))+"\n      ")],1)],1),r("v-card-text",[r("v-scale-transition",{attrs:{group:""}},e._l(e.dedupedSelectedFiles,function(t){return r("v-chip",{key:t,attrs:{close:!e.restoreRunning},on:{input:function(r){return e.removeSubtree(t)}}},[e._v(e._s(t))])}),1)],1),r("v-card-text",{directives:[{name:"show",rawName:"v-show",value:!e.restoreRunning,expression:"!restoreRunning"}]},[r("v-treeview",{attrs:{items:e.snapshotTree,"selected-color":"accent","open-on-click":"",selectable:"","item-key":"fullPath","loading-icon":"mdi-loading","expand-icon":"mdi-chevron-down","on-icon":"mdi-checkbox-marked","off-icon":"mdi-checkbox-blank-outline","indeterminate-icon":"mdi-checkbox-intermediate"},scopedSlots:e._u([{key:"prepend",fn:function(t){var n=t.item,s=t.open;return[n.children&&n.children.length?r("v-icon",[e._v(e._s(s?"mdi-folder-open":"mdi-folder"))]):r("v-icon",[e._v(e._s(e.$getFileIcon(n.name)))])]}}]),model:{value:e.selectedFiles,callback:function(t){e.selectedFiles=t},expression:"selectedFiles"}})],1),r("v-card-text",{directives:[{name:"show",rawName:"v-show",value:e.restoreRunning,expression:"restoreRunning"}]},[r("p",[e._v(e._s(e.$t("snapshot.restoring-to",{path:e.restorePath})))])])],1),r("folder-selector-dialog",{on:{"folder-selected":e.restoreToFolder},model:{value:e.restoreTargetSelectorOpen,callback:function(t){e.restoreTargetSelectorOpen=t},expression:"restoreTargetSelectorOpen"}})],1)},s=[],o=r("9ab4"),i=r("60a3"),a=r("f33f"),c=r("da9e"),l=r("8fb8"),d=r("421b"),u=r("df7c"),p=r("38ec"),h=r("be95"),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.restoreTargetSelectorOpen=!1,t.restoreProgress=100,t.restorePath=null,t.details=!1,t.selectedFiles=[],t}return o["d"](t,e),Object.defineProperty(t.prototype,"restoreRunning",{get:function(){return this.restoreProgress<100},enumerable:!0,configurable:!0}),t.prototype.onProgressChange=function(){var e=this;setTimeout(function(){requestAnimationFrame(function(){e.restoreRunning?(e.restoreProgress+=4*Math.random(),e.restoreProgress*=1.1):100!==e.restoreProgress&&(e.restoreProgress=100)})},1e3*Math.random())},t.prototype.resetSelection=function(){this.restoreRunning||(this.selectedFiles=[])},t.prototype.restoreToFolder=function(e){this.restoreProgress=1,this.restorePath=e,h["restoreSnapshot"](a["authModule"].userId,{snapshotId:this.snapshotId,selectedPaths:this.dedupedSelectedFiles,restorePath:e})},Object.defineProperty(t.prototype,"dedupedSelectedFiles",{get:function(){for(var e={},t=this.selectedFiles.slice().sort(function(e,t){return e.split("/").length-t.split("/").length}),r=0;r<t.length;++r){for(var n=t[r],s=!1;;){if(n=u["dirname"](n),"/"===n)break;if(e[n]){s=!0;break}}s||(e[t[r]]=!0)}return Object.keys(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repoId",{get:function(){return Number(a["routerModule"].params.repositoryId)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"snapshotId",{get:function(){return a["routerModule"].params.snapshotId},enumerable:!0,configurable:!0}),t.prototype.created=function(){this.setLoading(!0)},t.prototype.mounted=function(){return o["b"](this,void 0,void 0,function(){var e;return o["e"](this,function(t){switch(t.label){case 0:return[4,a["repositoriesModule"].getSnapshotDetails(this.repoId,this.snapshotId)];case 1:return e=t.sent(),e.payload&&(this.details=e.payload.details),this.setLoading(!1),[2]}})})},Object.defineProperty(t.prototype,"repoName",{get:function(){var e=a["repositoriesModule"].getById(this.repoId);return e&&e.name||!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"snapshotTree",{get:function(){if(!this.details)return!1;for(var e=[],t=[e],r=this.details.files,n=0;n<r.length;++n){var s=r[n],o=r[n+1],i=o&&o.path.startsWith(s.path),a=s.path.split("/").length-2,c={name:u["basename"](s.path),fullPath:s.path,children:i?[]:void 0};i&&(t[a+1]=c.children),t[a].push(c)}return e},enumerable:!0,configurable:!0}),t.prototype.removeSubtree=function(e){this.selectedFiles=this.selectedFiles.filter(function(t){return!t.startsWith(e+"/")&&t!==e})},o["c"]([Object(i["Watch"])("restoreProgress")],t.prototype,"onProgressChange",null),o["c"]([Object(i["Watch"])("restoreProgress")],t.prototype,"resetSelection",null),t=o["c"]([Object(i["Component"])({components:{Timeline:c["a"],SnapshotsList:l["a"],FolderSelectorDialog:p["a"]}})],t),t}(Object(i["Mixins"])(d["LoadingScreen"],d["DateFormatter"],d["FileIcons"])),v=f,b=v,g=r("2877"),m=r("6544"),y=r.n(m),_=r("8336"),O=r("b0af"),L=r("99d9"),w=r("12b2"),P=r("cc20"),$=r("132d"),F=r("8860"),S=r("ba95"),C=r("5d23"),x=r("8e36"),j=r("0789"),k=r("9910"),V=r("eb2a"),T=Object(g["a"])(b,n,s,!1,null,null,null);t["default"]=T.exports;y()(T,{VBtn:_["a"],VCard:O["a"],VCardText:L["b"],VCardTitle:w["a"],VChip:P["a"],VIcon:$["a"],VList:F["a"],VListTile:S["a"],VListTileSubTitle:C["b"],VListTileTitle:C["c"],VProgressLinear:x["a"],VScaleTransition:j["d"],VSpacer:k["a"],VTreeview:V["a"]})},ce7e:function(e,t,r){"use strict";r("58db");var n=r("6a18"),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t["a"]=n["a"].extend({name:"v-divider",props:{inset:Boolean,vertical:Boolean},render:function(e){return e("hr",{class:s({"v-divider":!0,"v-divider--inset":this.inset,"v-divider--vertical":this.vertical},this.themeClasses),attrs:this.$attrs,on:this.$listeners})}})}}]);
//# sourceMappingURL=snapshot.832ae1b2.js.map