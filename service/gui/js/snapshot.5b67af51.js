(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["snapshot"],{3260:function(e,t){function n(e){var t=[];for(var n in e)t.push(n);return t}t=e.exports="function"===typeof Object.keys?Object.keys:n,t.shim=n},"38ec":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{"max-width":"600px",scrollable:""},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[n("v-card",[n("v-card-title",{staticClass:"accent"},[n("v-layout",{attrs:{column:""}},[n("span",{staticClass:"headline"},[e._v(e._s(e.$t("folder-selector.select-folder")))]),n("div",{},[e._v(e._s(e.chosenLocation||e.$t("folder-selector.no-selection")))])]),n("v-spacer"),n("v-btn",{attrs:{icon:""},on:{click:e.refreshBrowser}},[n("v-icon",[e._v("mdi-refresh")])],1)],1),n("v-card-text",[n("file-browser",{ref:"fileBrowser",staticClass:"elevation-0",attrs:{"hide-chrome":"","hide-selection":"","folder-only":""},model:{value:e.chosenLocations,callback:function(t){e.chosenLocations=t},expression:"chosenLocations"}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"accent",flat:""},nativeOn:{click:function(t){e.isOpen=!1}}},[e._v(e._s(e.$t("common.interaction.close")))]),n("v-btn",{attrs:{color:"accent",flat:"",disabled:!e.chosenLocation},nativeOn:{click:function(t){e.$emit("folder-selected",e.chosenLocation),e.isOpen=!1}}},[e._v(e._s(e.$t("common.interaction.confirm")))])],1)],1)],1)},o=[],i=n("a34a"),s=n.n(i);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==y(t)&&"function"!==typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function y(e){return y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}var v=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":y(Reflect))&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e,t){if("object"===("undefined"===typeof Reflect?"undefined":y(Reflect))&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r["throw"](e))}catch(t){i(t)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});var m=n("60a3"),O=n("4796"),w=function(e){function t(){var e;return a(this,t),e=u(this,p(t).apply(this,arguments)),e.chosenLocations=[],e}return d(t,e),l(t,[{key:"onOpen",value:function(){return g(this,void 0,void 0,s.a.mark(function e(){return s.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.isOpen){e.next=4;break}return e.next=3,this.$refs.fileBrowser.manuallySetFolders([]);case 3:this.initialLocation&&this.onInitialLocationChange();case 4:case"end":return e.stop()}},e,this)}))}},{key:"onInitialLocationChange",value:function(){return g(this,void 0,void 0,s.a.mark(function e(){return s.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.initialLocation){e.next=10;break}if(this.chosenLocations=[this.initialLocation],!this.$refs.fileBrowser){e.next=8;break}return e.next=5,this.$refs.fileBrowser.manuallySetFolders([this.initialLocation]);case 5:return e.next=7,this.$refs.fileBrowser.openFolder(this.initialLocation);case 7:this.chosenLocations=[this.initialLocation];case 8:e.next=11;break;case 10:this.chosenLocations=[];case 11:case"end":return e.stop()}},e,this)}))}},{key:"refreshBrowser",value:function(){return g(this,void 0,void 0,s.a.mark(function e(){return s.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$refs.fileBrowser){e.next=7;break}return e.next=3,this.$refs.fileBrowser.refreshBrowser();case 3:return e.next=5,this.$refs.fileBrowser.manuallySetFolders([this.chosenLocation||this.initialLocation]);case 5:return e.next=7,this.$refs.fileBrowser.openFolder(this.chosenLocation||this.initialLocation);case 7:case"end":return e.stop()}},e,this)}))}},{key:"isOpen",get:function(){return this.value},set:function(e){this.$emit("input",e)}},{key:"chosenLocation",get:function(){return this.chosenLocations[0]||!1}}]),t}(m.Mixins());v([m.Prop({type:[Boolean],required:!0}),b("design:type",Boolean)],w.prototype,"value",void 0),v([m.Prop({type:String,default:""}),b("design:type",String)],w.prototype,"initialLocation",void 0),v([m.Watch("isOpen"),b("design:type",Function),b("design:paramtypes",[]),b("design:returntype",Promise)],w.prototype,"onOpen",null),v([m.Watch("initialLocation",{immediate:!0}),b("design:type",Function),b("design:paramtypes",[]),b("design:returntype",Promise)],w.prototype,"onInitialLocationChange",null),w=v([m.Component({components:{FileBrowser:O.default}})],w),exports.default=w;var _=void 0,S=n("2877"),j=n("6544"),P=n.n(j),x=n("8336"),F=n("b0af"),k=n("99d9"),L=n("12b2"),C=n("169a"),T=n("132d"),I=n("a722"),R=n("9910"),$=Object(S["a"])(_,r,o,!1,null,null,null);t["default"]=$.exports;P()($,{VBtn:x["a"],VCard:F["a"],VCardActions:k["a"],VCardText:k["b"],VCardTitle:L["a"],VDialog:C["a"],VIcon:T["a"],VLayout:I["a"],VSpacer:R["a"]})},"58db":function(e,t,n){},"68c7":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.currentlyLoading?n("fullscreen-loader",{attrs:{value:e.currentLoadingPercentage}}):n("div",{staticClass:"ma-4"},[n("v-card",[n("v-card-title",[n("span",{staticClass:"mr-2"},[e._v(e._s(e.$t("snapshot.snapshot"))+" "+e._s(e.snapshotId))]),n("v-chip",{staticClass:"white--text",class:e.chipClass,attrs:{label:"",small:""}},[e._v(e._s(e.repoName))])],1),n("v-card-text",[n("v-list",[n("v-list-tile",[n("v-list-tile-title",[e._v(e._s(e.$t("snapshot.date")))]),n("v-list-tile-sub-title",[e._v(e._s(e.dateDetails))])],1)],1)],1)],1),n("v-card",{staticClass:"mt-3"},[n("v-progress-linear",{staticClass:"ma-0",attrs:{value:e.restoreRunning?e.restoreProgress:0}}),n("v-card-title",{staticClass:"pt-1"},[n("span",{staticClass:"mr-2"},[e._v(e._s(e.$t("snapshot.files.files-in-snapshot")))]),n("v-chip",{attrs:{small:""}},[e._v(e._s(e.selectedFiles.length)+" / "+e._s(e.details.files.length)+" "+e._s(e.$t("snapshot.files.selected")))]),n("v-spacer"),n("v-btn",{attrs:{large:"",color:"accent",disabled:!e.selectedFiles.length||e.restoreRunning,outline:""},on:{click:function(t){e.restoreTargetSelectorOpen=!0}}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-backup-restore")]),e._v("\n        "+e._s(e.$t("snapshot.restore-now"))+"\n      ")],1)],1),n("v-card-text",{directives:[{name:"show",rawName:"v-show",value:!e.restoreRunning,expression:"!restoreRunning"}]},[n("snapshot-file-tree",{attrs:{"files-in-snapshot":e.details.files,selected:e.selectedFiles},on:{"update:selected":function(t){e.selectedFiles=t}}})],1),n("v-card-text",[n("v-scale-transition",{attrs:{group:""}},e._l(e.dedupedSelectedFiles,function(t){return n("v-chip",{key:t,attrs:{close:!e.restoreRunning},on:{input:function(n){return e.removeSubtree(t)}}},[e._v(e._s(t))])}),1)],1),n("v-card-text",{directives:[{name:"show",rawName:"v-show",value:e.restoreRunning,expression:"restoreRunning"}]},[n("p",[e._v(e._s(e.$t("snapshot.restoring-to",{path:e.restorePath})))])])],1),n("folder-selector-dialog",{on:{"folder-selected":e.restoreToFolder},model:{value:e.restoreTargetSelectorOpen,callback:function(t){e.restoreTargetSelectorOpen=t},expression:"restoreTargetSelectorOpen"}})],1)},o=[],i=n("9ab4"),s=n("60a3"),a=n("f33f"),c=n("da9e"),l=n("8fb8"),u=n("421b"),f=n("38ec"),p=n("f664"),d=n("be95"),h=n("e49c"),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.restoreTargetSelectorOpen=!1,t.restoreProgress=100,t.restorePath=null,t.details=!1,t.selectedFiles=[],t}return i["d"](t,e),Object.defineProperty(t.prototype,"restoreRunning",{get:function(){return this.restoreProgress<100},enumerable:!0,configurable:!0}),t.prototype.onProgressChange=function(){var e=this;setTimeout(function(){requestAnimationFrame(function(){e.restoreRunning?(e.restoreProgress+=8*Math.random(),e.restoreProgress*=1.3):100!==e.restoreProgress&&(e.restoreProgress=100)})},1e3*Math.random())},t.prototype.resetSelection=function(){this.restoreRunning||(this.selectedFiles=[])},t.prototype.restoreToFolder=function(e){this.restoreProgress=1,this.restorePath=e,d["restoreSnapshot"](a["authModule"].userId,this.repoId,{snapshotId:this.snapshotId,selectedPaths:this.dedupedSelectedFiles,restorePath:e})},Object.defineProperty(t.prototype,"dedupedSelectedFiles",{get:function(){return Object(p["dedupeSelectedFiles"])(this.selectedFiles)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repoId",{get:function(){return Number(a["routerModule"].params.repositoryId)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"snapshotId",{get:function(){return a["routerModule"].params.snapshotId},enumerable:!0,configurable:!0}),t.prototype.created=function(){this.setLoading(!0)},t.prototype.mounted=function(){return i["b"](this,void 0,void 0,function(){var e;return i["e"](this,function(t){switch(t.label){case 0:return e=this,[4,a["repositoriesModule"].getSnapshotDetails({repoId:this.repoId,snapshotId:this.snapshotId})];case 1:return e.details=t.sent(),this.setLoading(!1),[2]}})})},Object.defineProperty(t.prototype,"repoName",{get:function(){var e=a["repositoriesModule"].getById(this.repoId);return e&&e.name||!1},enumerable:!0,configurable:!0}),t.prototype.removeSubtree=function(e){this.selectedFiles=this.selectedFiles.filter(function(t){return!t.startsWith(e+"/")&&t!==e})},Object.defineProperty(t.prototype,"dateDetails",{get:function(){return this.details&&this.$d(this.details.date,"long")+" ("+this.$relativeDate(this.details.date)+")"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chipClass",{get:function(){return h["a"].job},enumerable:!0,configurable:!0}),i["c"]([Object(s["Watch"])("restoreProgress")],t.prototype,"onProgressChange",null),i["c"]([Object(s["Watch"])("restoreProgress")],t.prototype,"resetSelection",null),t=i["c"]([Object(s["Component"])({components:{Timeline:c["a"],SnapshotsList:l["a"],FolderSelectorDialog:f["default"],SnapshotFileTree:p["default"]}})],t),t}(Object(s["Mixins"])(u["LoadingScreen"],u["DateFormatter"],u["FileIcons"])),v=y,b=v,g=n("2877"),m=n("6544"),O=n.n(m),w=n("8336"),_=n("b0af"),S=n("99d9"),j=n("12b2"),P=n("cc20"),x=n("132d"),F=n("8860"),k=n("ba95"),L=n("5d23"),C=n("8e36"),T=n("0789"),I=n("9910"),R=Object(g["a"])(b,r,o,!1,null,null,null);t["default"]=R.exports;O()(R,{VBtn:w["a"],VCard:_["a"],VCardText:S["b"],VCardTitle:j["a"],VChip:P["a"],VIcon:x["a"],VList:F["a"],VListTile:k["a"],VListTileSubTitle:L["b"],VListTileTitle:L["c"],VProgressLinear:C["a"],VScaleTransition:T["d"],VSpacer:I["a"]})},"7fae":function(e,t,n){var r=Array.prototype.slice,o=n("3260"),i=n("997d"),s=e.exports=function(e,t,n){return n||(n={}),e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||"object"!=typeof e&&"object"!=typeof t?n.strict?e===t:e==t:l(e,t,n))};function a(e){return null===e||void 0===e}function c(e){return!(!e||"object"!==typeof e||"number"!==typeof e.length)&&("function"===typeof e.copy&&"function"===typeof e.slice&&!(e.length>0&&"number"!==typeof e[0]))}function l(e,t,n){var l,u;if(a(e)||a(t))return!1;if(e.prototype!==t.prototype)return!1;if(i(e))return!!i(t)&&(e=r.call(e),t=r.call(t),s(e,t,n));if(c(e)){if(!c(t))return!1;if(e.length!==t.length)return!1;for(l=0;l<e.length;l++)if(e[l]!==t[l])return!1;return!0}try{var f=o(e),p=o(t)}catch(d){return!1}if(f.length!=p.length)return!1;for(f.sort(),p.sort(),l=f.length-1;l>=0;l--)if(f[l]!=p[l])return!1;for(l=f.length-1;l>=0;l--)if(u=f[l],!s(e[u],t[u],n))return!1;return typeof e===typeof t}},8097:function(e,t,n){"use strict";var r=n("9859"),o=n.n(r);n.o(r,"dedupeSelectedFiles")&&n.d(t,"dedupeSelectedFiles",function(){return r["dedupeSelectedFiles"]}),t["default"]=o.a},9859:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function s(e,t){return!t||"object"!==y(t)&&"function"!==typeof t?a(e):t}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function f(e){return h(e)||d(e)||p()}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function d(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function h(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function y(e){return y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}var v=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":y(Reflect))&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=this&&this.__metadata||function(e,t){if("object"===("undefined"===typeof Reflect?"undefined":y(Reflect))&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var g=n("60a3"),m=n("421b"),O=n("df7c"),w=n("7fae");t.dedupeSelectedFiles=function(e){for(var t={},n=f(e).sort(function(e,t){return e.split("/").length-t.split("/").length}),r=0;r<n.length;++r){for(var o=n[r],i=!1;;){if(o=O.dirname(o),"/"===o)break;if(t[o]){i=!0;break}}i||(t[n[r]]=!0)}return Object.keys(t)};var _=function(e){function t(){var e;return r(this,t),e=s(this,c(t).apply(this,arguments)),e.selectedFiles=[],e}return l(t,e),i(t,[{key:"setSelected",value:function(e){}},{key:"onUpdateSelected",value:function(e,t){w.default(e,t)||(this.selectedFiles=this.selected)}},{key:"onUpdateSelectedFiles",value:function(e,t){w.default(e,t)||this.setSelected(e)}},{key:"snapshotTree",get:function(){if(!this.filesInSnapshot.length)return[];for(var e=[],t=[e],n=this.filesInSnapshot,r=0;r<n.length;++r){var o=n[r],i=n[r+1],s=i&&i.startsWith(o),a=o.split("/").length-2,c={name:O.basename(o),fullPath:o,children:s?[]:void 0};s&&(t[a+1]=c.children),t[a].push(c)}return e}}]),t}(g.Mixins(m.FileIcons));v([g.Prop({type:Array,required:!0}),b("design:type",Array)],_.prototype,"selected",void 0),v([g.Emit("update:selected"),b("design:type",Function),b("design:paramtypes",[Array]),b("design:returntype",void 0)],_.prototype,"setSelected",null),v([g.Watch("selected"),b("design:type",Function),b("design:paramtypes",[Array,Array]),b("design:returntype",void 0)],_.prototype,"onUpdateSelected",null),v([g.Watch("selectedFiles"),b("design:type",Function),b("design:paramtypes",[Array,Array]),b("design:returntype",void 0)],_.prototype,"onUpdateSelectedFiles",null),v([g.Prop({type:Array,required:!0}),b("design:type",Array)],_.prototype,"filesInSnapshot",void 0),_=v([g.Component({components:{}})],_),t.default=_},"997d":function(e,t){var n="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function r(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function o(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}t=e.exports=n?r:o,t.supported=r,t.unsupported=o},c004:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-treeview",{attrs:{items:e.snapshotTree,"selected-color":"accent","open-on-click":"",selectable:"","item-key":"fullPath","loading-icon":"mdi-loading","expand-icon":"mdi-chevron-down","on-icon":"mdi-checkbox-marked","off-icon":"mdi-checkbox-blank-outline","indeterminate-icon":"mdi-checkbox-intermediate"},scopedSlots:e._u([{key:"prepend",fn:function(t){var r=t.item,o=t.open;return[r.children&&r.children.length?n("v-icon",{staticClass:"yellow--text text--darken-2"},[e._v(e._s(o?"mdi-folder-open":"mdi-folder"))]):n("v-icon",[e._v(e._s(e.$getFileIcon(r.name)))])]}}]),model:{value:e.selectedFiles,callback:function(t){e.selectedFiles=t},expression:"selectedFiles"}})},o=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},ce7e:function(e,t,n){"use strict";n("58db");var r=n("6a18"),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t["a"]=r["a"].extend({name:"v-divider",props:{inset:Boolean,vertical:Boolean},render:function(e){return e("hr",{class:o({"v-divider":!0,"v-divider--inset":this.inset,"v-divider--vertical":this.vertical},this.themeClasses),attrs:this.$attrs,on:this.$listeners})}})},f664:function(e,t,n){"use strict";var r=n("c004"),o=n("8097");n.o(o,"dedupeSelectedFiles")&&n.d(t,"dedupeSelectedFiles",function(){return o["dedupeSelectedFiles"]});var i=n("2877"),s=n("6544"),a=n.n(s),c=n("132d"),l=n("eb2a"),u=Object(i["a"])(o["default"],r["a"],r["b"],!1,null,null,null);t["default"]=u.exports,a()(u,{VIcon:c["a"],VTreeview:l["a"]})}}]);
//# sourceMappingURL=snapshot.5b67af51.js.map